{"title":"Loading Data, Organizing, and Converting to a Genind Object","markdown":{"yaml":{"title":""},"headingText":"Loading Data, Organizing, and Converting to a Genind Object","containsRefs":false,"markdown":"\n\n\nThe data used for our analyses has been in FASTA format from the beginning, so the initial step is to load this FASTA file into R. The function used for this belongs to the `adegenet` package, and it automatically converts the data into DNAbin format\n\n```{r, results='hide'}\nlibrary(adegenet)\nusflu.dna2 <- fasta2DNAbin(file = 'alinhamentocerto.fas')\n```\n\nConverts the row names (or identifiers) of the object `usflu.dna2` into character strings and stores them in the variable `isolate_name`. This is useful for manipulating and verifying the names of the isolates.\n\n```{r}\nisolate_name <- as.character(rownames(usflu.dna2))\n```\n\nA variable `grupos` is created that assigns the value \"Grupo1\" to isolates whose names start with \"UFV\" and \"Grupo2\" to the rest of the isolates. The `startsWith` function checks whether the isolate's name begins with \"UFV\".\n\n```{r}\ngrupos <- ifelse(startsWith(isolate_name, \"UFV\"), \"Grupo1\", \"Grupo2\")\n```\n\nThe function `DNAbin2genind` converts a DNAbin object into a genind object, which is used for population genetic analysis. The argument `pop = grupos` assigns the groups (previously defined as \"Grupo1\" and \"Grupo2\") to the isolates within the genind object. This enables subsequent analyses of population structure and genetic diversity based on these defined groups.\n\n```{r}\nusflu.genind <- DNAbin2genind(x = usflu.dna2, pop = grupos)\nusflu.genind\n```\n\n## Organizing the data for AMOVA\n\nThe `poppr` library, which is used for population genetic analysis\n\n```{r, results='hide'}\nlibrary(\"poppr\")\n```\n\nThe variable `grupos` is a vector that defines the groups for analysis. It contains 27 individuals labeled as \"Grupo1\" and 32 individuals labeled as \"Grupo2\". `df_grupos` converts the vector `grupos` into a dataframe, which can be used as a stratification attribute (`strata`) in the genetic object (`genind`)\n\n```{r, results='hide'}\ngrupos <- c(rep(\"Grupo1\", 27), rep(\"Grupo2\", 32))\ndf_grupos <- data.frame(grupos)\n\n```\n\nThis assigns the previously defined groups (`df_grupos`) to the genetic object `usflu.genind`. **This enables the analysis of population structure based on the defined groups.**\n\n```{r}\nstrata(usflu.genind) <- df_grupos\n\n```\n\nThe function `as.genclone` converts the genetic object `usflu.genind` into a format suitable for clonality analysis (GenClone). This is useful for detecting genetic clones within the population.\n\n```{r}\nusflu.genind <- as.genclone(usflu.genind)\nusflu.genind\ntable(strata(usflu.genind, ~grupos))  # Populations\n```\n\n## AMOVA\n\nThe method calculates differences in allelic content between haplotypes using a matrix of **Euclidean squared distances**, consistent with the approach used by **Arlequin**. However, analysts can customize this method according to their preferences. In this example, the `method` is set to **`ade4`**. If you choose to use another method, switch to **`pegas`**.\n\n```{r}\namovac <- poppr.amova(usflu.genind, ~grupos, method = \"ade4\")\namovac\n```\n\nReturns the available arguments for the `poppr.amova` function, which can help understand how to configure the analysis.\n\n```{r}\nargs(poppr.amova)\n```\n","srcMarkdownNoYaml":"\n\n## Loading Data, Organizing, and Converting to a Genind Object\n\nThe data used for our analyses has been in FASTA format from the beginning, so the initial step is to load this FASTA file into R. The function used for this belongs to the `adegenet` package, and it automatically converts the data into DNAbin format\n\n```{r, results='hide'}\nlibrary(adegenet)\nusflu.dna2 <- fasta2DNAbin(file = 'alinhamentocerto.fas')\n```\n\nConverts the row names (or identifiers) of the object `usflu.dna2` into character strings and stores them in the variable `isolate_name`. This is useful for manipulating and verifying the names of the isolates.\n\n```{r}\nisolate_name <- as.character(rownames(usflu.dna2))\n```\n\nA variable `grupos` is created that assigns the value \"Grupo1\" to isolates whose names start with \"UFV\" and \"Grupo2\" to the rest of the isolates. The `startsWith` function checks whether the isolate's name begins with \"UFV\".\n\n```{r}\ngrupos <- ifelse(startsWith(isolate_name, \"UFV\"), \"Grupo1\", \"Grupo2\")\n```\n\nThe function `DNAbin2genind` converts a DNAbin object into a genind object, which is used for population genetic analysis. The argument `pop = grupos` assigns the groups (previously defined as \"Grupo1\" and \"Grupo2\") to the isolates within the genind object. This enables subsequent analyses of population structure and genetic diversity based on these defined groups.\n\n```{r}\nusflu.genind <- DNAbin2genind(x = usflu.dna2, pop = grupos)\nusflu.genind\n```\n\n## Organizing the data for AMOVA\n\nThe `poppr` library, which is used for population genetic analysis\n\n```{r, results='hide'}\nlibrary(\"poppr\")\n```\n\nThe variable `grupos` is a vector that defines the groups for analysis. It contains 27 individuals labeled as \"Grupo1\" and 32 individuals labeled as \"Grupo2\". `df_grupos` converts the vector `grupos` into a dataframe, which can be used as a stratification attribute (`strata`) in the genetic object (`genind`)\n\n```{r, results='hide'}\ngrupos <- c(rep(\"Grupo1\", 27), rep(\"Grupo2\", 32))\ndf_grupos <- data.frame(grupos)\n\n```\n\nThis assigns the previously defined groups (`df_grupos`) to the genetic object `usflu.genind`. **This enables the analysis of population structure based on the defined groups.**\n\n```{r}\nstrata(usflu.genind) <- df_grupos\n\n```\n\nThe function `as.genclone` converts the genetic object `usflu.genind` into a format suitable for clonality analysis (GenClone). This is useful for detecting genetic clones within the population.\n\n```{r}\nusflu.genind <- as.genclone(usflu.genind)\nusflu.genind\ntable(strata(usflu.genind, ~grupos))  # Populations\n```\n\n## AMOVA\n\nThe method calculates differences in allelic content between haplotypes using a matrix of **Euclidean squared distances**, consistent with the approach used by **Arlequin**. However, analysts can customize this method according to their preferences. In this example, the `method` is set to **`ade4`**. If you choose to use another method, switch to **`pegas`**.\n\n```{r}\namovac <- poppr.amova(usflu.genind, ~grupos, method = \"ade4\")\namovac\n```\n\nReturns the available arguments for the `poppr.amova` function, which can help understand how to configure the analysis.\n\n```{r}\nargs(poppr.amova)\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"amova_R.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.553","editor":"visual","theme":"united","title":""},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}